<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Screens</title>
    <style id="shake" type="text/css"></style>
    <script src=”https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js”></script>
  </head>
  <body style="margin:0;padding:0">
    <div id="drawing_board" style="position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);"><canvas></canvas></div>
    <script>
      function render_rapture(tokenData) {
        let t,e,i,s,r=Math.PI,a=2*Math.PI,l=Math.sin,n=Math.asin,p=Math.cos,o=Math.round,f=Math.floor,c=Math.sqrt,d=Math.cbrt;t=Uint32Array.from([0,1,e=i=2,3].map((t=>parseInt(tokenData.hash.substr(8*t+2,8),16)))),s=()=>(i=t[3],t[3]=t[2],t[2]=t[1],t[1]=e=t[0],i^=i<<11,t[0]^=i^i>>>8^e>>>19,t[0]/4294967296);let y=(t=0,e=1)=>t+(e-t)*s(),u=(t,e)=>f(y(t,e+1)),m=(t,e)=>{let i,h,s,r,a=[],l=[],n=0,p=[...e];for(;n++<e.length;)l.push(n-1);for(;0<t--;)i=p.reduce(((t,e,i)=>[...t,e+(t[i-1]||0)]),[]),r=i.length-1,h=y(0,i[r]),s=i.findIndex((t=>t>h)),s=0>s?r:s,a.push(l.splice(s,1)[0]),p.splice(s,1);return a},x=[u(0,1e9),u(0,1e9)],b=m(1,[35,5,25,10,15,10])[0],w=1!=b&&(5==b||.3>y()),q=y(),v=.1>q&&1!=b?.02:.9>q?.04:.08,E=w?1250:.1>q?750:.9>q?500:250,k=y(),T=.05>k?3:1,S=.95<k?3:1,P=m(1,[48,48,4])[0],M=.5>y(),$=2>P?1:M?1.414214:.707107,B=m(1,[1,1,1,1])[0]*r/2+(.25>y()?r/4:0),I=m(1,[7,30,20,10,3,20,10])[0],R=y(),A=m(6,[2,3,3,3,1,2]),W=.7>y(),_=m(1,[30,40,5,10,15])[0],C=f(5*(1-(1-y())**.5)+2),D=m(7==C?6:C,[2,3,3,3,1,2]),H=m(1,[30,60,10])[0],j=.1>y(),L=j?2:m(1,[60,35,5])[0],N=.9>y(),U=.3>y();1==b&&(T=S=1),250!=E&&(3==T||3==S)&&(E=1e3),1!=_||W||0!=A[0]||A.push(A.shift());class z{constructor(t,e){this.x=t,this.y=e}d(t){let e=this.x-t.x,i=this.y-t.y;return c(e*e+i*i)}s(t){return this.x-=t.x,this.y-=t.y,this}a(t){return this.x+=t.x,this.y+=t.y,this}t(t,e){return this.x+=t,this.y+=e,this}m(t){return this.x*=t,this.y*=t,this}n(){return this.m(1/c(this.x**2+this.y**2))}cp(){return new z(this.x,this.y)}}deBoor=(t,e,i,h)=>{if(0==t)return h[e%h.length].cp();let s=(i-e)/(4-t);return deBoor(t-1,e-1,i,h).m(1-s).a(deBoor(t-1,e,i,h).m(s))};class F{constructor(t){this.h=!1,this.p=t,this.a=[]}o(t){return this.h=t,this}ap(t,e){return this.a.push(new z(t,e)),this}t(t=1,e=0,i=0){return this.a.forEach((h=>{h.x=h.x*t+e,h.y=h.y*t+i})),this}rot(t){let e=l(t),i=p(t);return this.a.forEach((t=>{let h=t.x*i-t.y*e,s=t.x*e+t.y*i;t.x=h,t.y=s})),this}ad(t){if(2>this.a.length)return;let e,i,h,s,r,a,l,n,p=[];for(l=0;l<this.a.length;l++)if(e=l==this.a.length-1?0:l+1,i=this.a[l],p.push(i),h=this.a[e],s=i.d(h),!(t>=s))for(r=ceil(s/t),a=h.cp().s(i).m(1/r),n=0;n<r-1;n++)i=i.cp().a(a),p.push(i);return this.a=p,this}rm(t){if(2>this.a.length)return;let e,i,h,s,r=[this.a[0]];for(s=1;s<this.a.length;s++)e=this.a[s],i=r[r.length-1],h=e.d(i),t<=h&&r.push(e);return this.a=r,this}bs(t){let e=this.a.length+3,i=3;for(t=t*(e-4)+3;i<e&&!(t>=i&&t<=i+1);)i++;return deBoor(3,i,t,this.a)}cp(){let t=new F(this.p);return t.a=this.a.map((t=>t.cp())),t.h=this.h,t}}let G=(t,e)=>new F(t,e),J=(t,e)=>{let i=new p5;return i.noiseSeed(t),i.noiseDetail(4,.5),(t,h)=>i.noise((t+5e5)*e,(h+5e5)*e)},K=2147483647,O=t=>1664525*t+1013904223&K,Q=1/(K+1),V=(t,e)=>16777619*t+e&K,X=(t,e,i)=>{let h,s,r,a,l,n,p,o,c,d,y,g,u=f(t),m=f(e),x=t-u,b=1-x,w=e-m,q=1-w,v=[0,-1,1],E=1e9;for(x*=x,w*=w,b*=b,q*=q,c=0;3>c;c++)for(d=0;3>d;d++)if(!(1==c&&E<x||2==c&&E<b||1==d&&E<w||2==d&&E<q))for(l=u+v[c],n=m+v[d],p=l-t,o=n-e,h=O(V(l+i&K,n+i&K)),s=196662675>(k=h)?1:511322955>k?2:930869995>k?3:1350417036>k?4:1686054668>k?5:1909813089>k?6:2037675044>k?7:2101606022>k?8:9,y=0;y<s;++y)h=O(h),r=h*Q+p,h=O(h),a=h*Q+o,g=r*r+a*a,g<E&&(E=g);var k;return E},Y=t=>(e,i)=>{let h=.01,s=1,r=0,a=3;for(;a--;)r+=X(e*h,i*h,t)*s,h*=2,s*=.5;return r},Z=(t,e,i,h,s)=>new z(-(h(t,e+s)-h(t,e-s))/(2*s),(i(t+s,e)-i(t-s,e))/(2*s)),tt=(t,e=3,i=1/16)=>t<i?i*t/(t+e*(i-t)):(1-i)*(t-1)/(1-t-e*(i-t))+1;class et{constructor(t,e,i){this.p=[],this.at=[...e],t.forEach((t=>this.p.push(this.rgb_ok(t)))),this.f=i,this.ps=new p5}ca(t,e=!1,i=!0){t=this.f?t**.5:((t,e=.01)=>t<e?0:(t-e)/(1-e))(t);let h,s,r=1;for(;r<this.at.length-1&&this.at[r]<=t;)r++;return s=(t-this.at[r-1])/(this.at[r]-this.at[r-1]),s=1>s?0<s?s:0:1,h=this.ok_rgb([this.ps.lerp(this.p[r-1][0],this.p[r][0],s),this.ps.lerp(this.p[r-1][1],this.p[r][1],s),this.ps.lerp(this.p[r-1][2],this.p[r][2],s)]),i?(h.push(e?1:(1-tt(t))*(j&&!this.f?3*tt(t,9,.2):1)),`rgba(${h[0]}, ${h[1]}, ${h[2]}, ${h[3]})`):h}rgb_ok(t){let e=d(.4122214708*t[0]+.5363325363*t[1]+.0514459929*t[2]),i=d(.2119034982*t[0]+.6806995451*t[1]+.1073969566*t[2]),h=d(.0883024619*t[0]+.2817188376*t[1]+.6299787005*t[2]);return[.2104542553*e+.793617785*i-.0040720468*h,1.9779984951*e-2.428592205*i+.4505937099*h,.0259040371*e+.7827717662*i-.808675766*h]}ok_rgb(t){let e=(t[0]+.3963377774*t[1]+.2158037573*t[2])**3,i=(t[0]-.1055613458*t[1]-.0638541728*t[2])**3,h=(t[0]-.0894841775*t[1]-1.291485548*t[2])**3;return[4.0767416621*e-3.3077115913*i+.2309699292*h,-1.2684380046*e+2.6097574011*i-.3413193965*h,-.0041960863*e-.7034186147*i+1.707614701*h]}}let it=(t,e,i=!1)=>new et(t,e,i);var ht=t=>{let e=[239,241,220],i=[52,51,50],h=[[[244,200,5],[240,182,5],[200,142,5]],[[225,139,117],[201,75,64],[152,51,42]],[[151,176,201],[62,111,182],[57,81,116]],[[156,201,149],[72,161,77],[62,106,64]],[[237,169,182],[235,97,143],[144,74,97]],[[191,151,190],[130,77,147],[95,56,107]]],s=it(1==_?[h[A[0]][W?2:0],h[A[0]][W?0:2]]:W?[i,e]:[e,i],[0,1],!0),r=t=>{let s=[e,...h[A[H?t:0]],i];return W&&s.reverse(),it(s,[0,.1,.4,.7,1])},a=t=>it([h[A[H?t:1]][W?2:0],h[A[H?t:1]][1],h[A[0]][1],h[A[0]][W?0:2]],[0,.33,.67,1]);if(2==_)return Array(t+1).fill(s);if(3==_)return[...Array(t).fill((t=>{let s=[e,...D.map((t=>h[t][1])),i];W&&s.reverse();let r=[0],a=0,l=1/(s.length-1);for(;a<1-l/2;)r.push(a+=l);return it(s,r)})()),s];if(4==_&&2<t)return[...(t=>{let s=[e,h[A[0]][1],i];W&&s.reverse();let r=s[2],a=it(s,[-.2,.5,1.2],!0),l=[];for(let e=0;1>=e;e+=1/(t-1))l.push(it([a.ca(e,!0,!1),r],[0,1]));return l})(t),s];let l=1==_?[a(1),a(2),a(3),a(4),a(5)]:[r(0),r(1),r(2),r(3),r(4)];return 1==H&&(l=l.map(((t,e)=>l[e%2]))),[...l.slice(0,t),s]};let st,rt,at=window,lt=at.innerWidth,nt=at.innerHeight,pt=lt/nt,ot=pt>$,ft=at.devicePixelRatio,ct=(ot?nt:lt)*ft,dt=ct/(100*(M?ot?1:$:pt<$?1:1/$)),yt=document,gt=yt.getElementById("drawing_board"),ut=yt.getElementById("shake");gt.getElementsByTagName("canvas")[0].remove();let mt=Array(11).fill(1).map(((t,e)=>`${10*e}% {transform: translate(${o(2*y()-1)}mm, ${o(2*y()-1)}mm) rotate(${o(2*y()-1)}deg);}`));mt="@keyframes shake {\n"+mt.join("\n")+"\n}",ut.innerHTML=mt,yt.body.style.overflow="hidden",st=yt.createElement("canvas"),rt=yt.createElement("canvas");let xt=st.getContext("2d"),bt=rt.getContext("2d"),wt=w?Y(x[0]):J(x[0],v/T),qt=w?Y(x[1]):J(x[1],v/S),vt=(()=>{let t=2==P?70.71068:50,e=(t,e)=>[...t,...e.splice(1,e.length-1)],i=e=>G(e).ap(-t,-50).ap(t,-50).ap(t,50).ap(-t,50),s=(t,e=15)=>G(t).ap(-e,-e).ap(e,-e).ap(e,e).ap(-e,e),o=t=>{let e,i=[],h=0;for(;5>i.length;){let t=35*c(y()),s=y()*a;e=new z(p(s)*t,l(s)*t),(50<h++||i.map((t=>25<t.d(e))).reduce(((t,e)=>t&&e),!0))&&i.push(e)}return i.map(((e,i)=>t[i].t(1,e.x,e.y)))};return g=15*(1-R),h=n(.05+R/2.5),ci=(t,e=17.5)=>{let i,h=G(t);for(i=0;i<a;i+=r/200)h.ap(p(i)*e,l(i)*e);return h},sh4=t=>[i(t[4].p),t[0],t[1].rot(r/2),t[2].rot(r),t[3].rot(3*r/2)],sq1=t=>[i(t[1]),s(t[0],25),ci(t[0],7+g).o(!0)],sq2=t=>[i(t[1]),s(t[0],25),s(t[0],7+g).o(!0)],sq3=t=>[i(t[2]),s(t[0],25),s(t[0],14+.6*g).o(!0),s(t[1],12.5-.6*g)],sq4=t=>sh4(t.map((t=>G(t,!0).ap(9+g,25).ap(-9-g,25).ap(0,16-g)))),sq5=t=>[i(t[5]),...o([,,,,,].fill(0).map(((e,i)=>s(t[i],10))))],sq2a=t=>[i(t[2]),G(t[0]).ap(-25,-25).ap(5+g,-25).ap(-25,5+g),G(t[1]).ap(25,25).ap(-5-g,25).ap(25,-5-g)],sq3a=t=>[i(t[3]),G(t[0]).ap(-25,-25).ap(-10+g,-25).ap(-25,-10+g),G(t[1]).ap(25,-25).ap(25,-20+g).ap(-20+g,25).ap(-25,25).ap(-25,20-g).ap(20-g,-25),G(t[2]).ap(25,25).ap(10-g,25).ap(25,10-g)],ci1=t=>[i(t[1]),ci(t[0],30),s(t[0],5+g).o(!0)],ci2=t=>[i(t[1]),ci(t[0],30),ci(t[0],12.5+g).o(!0)],ci3=t=>[i(t[2]),ci(t[0],30),ci(t[0],17+.7*g).o(!0),ci(t[1],15-.7*g)],ci4=t=>sh4(t.map((t=>{let e,i=G(t,!0).ap(30*p(r/2-h),30*l(h));for(e=h;e<=r/2-h;e+=(r/2-2*h)/50)i.ap(30*p(e),30*l(e));return i}))),ci5=t=>[i(t[5]),...o([,,,,,].fill(0).map(((e,i)=>ci(t[i],12))))],ci2a=t=>{let e,s=G(t[0]),a=G(t[1]);for(e=h;e<=r-h;e+=(r-2*h)/100)s.ap(30*p(e),30*l(e)),a.ap(30*p(e),30*l(e));return[i(t[2]),s,a.rot(r)]},ci3a=t=>{let e,h=G(t[0]),s=G(t[1]),a=G(t[2]),o=.3*R,f=n(.45+o);for(e=f;e<r-f+(r-2*f)/100;e+=(r-2*f)/50)h.ap(30*p(e),30*l(e)),a.ap(30*p(e),30*l(e));for(f=n(.45-o),e=r-f;e<r+f+f/50;e+=f/25)s.ap(30*p(e),30*l(e));for(e=-f;e<f+f/50;e+=f/25)s.ap(30*p(e),30*l(e));return[i(t[3]),h,s,a.rot(r)]},0===I?2==P?e(ci1(ht(1)),sq1(ht(1))):P?ci1(ht(1)):sq1(ht(1)):1===I?2==P?e(ci2(ht(1)),sq2(ht(1))):P?ci2(ht(1)):sq2(ht(1)):2===I?2==P?e(ci3(ht(2)),sq3(ht(2))):P?ci3(ht(2)):sq3(ht(2)):3===I?2==P?e(ci4(ht(4)),sq4(ht(4))):P?ci4(ht(4)):sq4(ht(4)):4===I?2==P?e(ci5(ht(5)),sq5(ht(5))):P?ci5(ht(5)):sq5(ht(5)):5===I?2==P?e(ci2a(ht(2)),sq2a(ht(2))):P?ci2a(ht(2)):sq2a(ht(2)):6===I?2==P?e(ci3a(ht(3)),sq3a(ht(3))):P?ci3a(ht(3)):sq3a(ht(3)):void 0})(),Et=rt.style;rt.width=st.width=cw=o(ct*(ot?$:1)),rt.height=st.height=ch=o(ct/(ot?1:$)),Et.width=st.style.width=cw/ft+"px",Et.height=st.style.height=ch/ft+"px",Et.position="absolute",Et.top="0",Et.left="0",Et.animation="shake 0.5s",Et.animationIterationCount="infinite",vt.forEach(((t,e)=>t.rot(e?B:0))),2==P&&(vt.forEach(((t,e)=>t.t(1,e?34*(.5<e/vt.length?-1:1):0))),.5>y()&&vt.forEach((t=>t.rot(r))),!M&&vt.forEach((t=>t.rot(r/2)))),gt.prepend(rt),gt.prepend(st);let kt=new class{constructor(t,e){this.p=t.map((t=>[t])),this.fr=t.map((t=>t.cp().ad(e).rm(e))),this.x=0,this.y=0,this.m=0,this.n=0}f(t,e,i,h,s){this.p.forEach(((r,a)=>{if(!N&&0==a)return;let l,n,p=this.fr[a];for(l=0;l<t;l++){for(n=0;n<e;n++)!w&&a&&4e3>p.a.length&&p.ad(4*i),p.a.forEach((t=>t.a(Z(t.x,t.y,h,s,.1))));r.push(p.cp())}})),this.n+=t}sp(t,e,i,h,s,r){let a=this.dx,l=this.dy,n=this.m;e.moveTo(t[0].x*n+a,t[0].y*n+l);for(let i=1;i<t.length;i++)e.lineTo(t[i].x*n+a,t[i].y*n+l);e.strokeStyle=i,e.lineWidth=s,e.fillStyle=h,e.closePath(),r?e.stroke():e.fill("evenodd")}cp(t,e,i,h){let s=this.dx,r=this.dy,l=this.m;e.fillStyle=i,t.forEach((t=>{e.beginPath(),e.arc(t.x*l+s,t.y*l+r,.25*h*l,0,a),e.fill()}))}bp(t,e,i,h){if(0!=h%7)return;let s,r,a=this.dx,l=this.dy,n=this.m;for(e.beginPath(),s=0;1>s;s+=1e-4)r=t.bs(s),0==s?e.moveTo(r.x*n+a,r.y*n+l):e.lineTo(r.x*n+a,r.y*n+l);e.closePath(),e.lineWidth=n/5,e.strokeStyle=i,e.stroke()}hp(t,e,i){let h,s,r,a,l,n=this.dx,p=this.dy,o=this.m;for(e.lineWidth=o/5,h=0;100>h;h++)e.strokeStyle=t.p.ca(i+(y()-.5)/10),l=y(),s=t.bs(l),r=t.bs(l-.05).s(s).n(),a=s.cp().s(t.bs(l+.05)).n().a(r),r.x=a.y,r.y=-a.x,r.n(),a=s.cp().a(r.cp().m(-.5)),s.a(r.m(.5)),e.beginPath(),e.moveTo(s.x*o+n,s.y*o+p),e.lineTo(a.x*o+n,a.y*o+p),e.stroke()}rp(t,e,i){let h,s,r=this.dx,l=this.dy,n=this.m;for(h=0;50>h;h++)e.fillStyle=t.p.ca(i+(y()-.5)/5),s=t.bs(y()),e.beginPath(),e.arc(s.x*n+r,s.y*n+l,.8*y()*n,0,a),e.fill()}mp(t,e,i,h){if(0!=e%50||e+50>=t.length)return;let s,r,a,l,n,p=this.dx,o=this.dy,f=this.m,c=0==e?50:49,d=Array(10+e).fill(1).map((()=>1+y())).reduce(((t,e,i)=>[...t,e+(t[i-1]||0)]),[]);for(0==e&&(e=1),d=d.map((t=>t/d[d.length-1])),d.unshift(0),s=0;s<d.length-1;s++){for(i.beginPath(),a=d[s],l=t[e].bs(a),i.moveTo(l.x*f+p,l.y*f+o),a+=1e-4;a<d[s+1];)l=t[e].bs(a),i.lineTo(l.x*f+p,l.y*f+o),a+=1e-4;for(r=e;r<=e+c;r++)l=t[r].bs(d[s+1]),i.lineTo(l.x*f+p,l.y*f+o);for(;a>d[s];)l=t[e+c].bs(a),i.lineTo(l.x*f+p,l.y*f+o),a-=1e-4;for(r=e+c;r>e;r--)l=t[r].bs(d[s]),i.lineTo(l.x*f+p,l.y*f+o);i.closePath(),n=t[e].p.ca(h+(y()-.5)/10,!0),i.fillStyle=n,i.strokeStyle=t[e].p.ca(1-h,!0),i.lineWidth=f/50,i.fill(),i.stroke()}}dp(t,e,i,h=!1){if(0!=e||h||5==b){let s=e/(t.length-2),r=t[0].p.ca(s);h||0==b?(i.beginPath(),this.sp(t[e].a,i,r,r,this.m/50,!0),this.sp(t[e+1].a,i,r,r,this.m/50,!1)):1==b?this.cp(t[e].a,i,r,(1-s)*(1-(1-s)**100)):2==b?this.bp(t[e],i,r,e):3==b?this.hp(t[e],i,s):4==b?this.rp(t[e],i,s):this.mp(t,e,i,s)}}df(t,e=0){this.p.forEach(((i,h)=>{if(0==h)return;let s,r=i[f(e*(i.length-2))].a,a=this.dx,l=this.dy,n=this.m;for(i[0].h||t.beginPath(),t.moveTo(r[0].x*n+a,r[0].y*n+l),s=1;s<r.length;s++)t.lineTo(r[s].x*n+a,r[s].y*n+l);t.closePath(),t.fillStyle=i[0].p.ca(0,!0),h!=this.p.length-1&&this.p[h+1][0].h||t.fill("evenodd")}))}d(t,e,i){this.dx,this.dy;let h,s=this.p[0].length-1,r=0==b?.01:0;if(t.fillStyle=this.p[0][0].p.ca(1,!0),t.fillRect(0,0,2*this.dx,2*this.dy),U)for(let h=0;h<i;h++)t.fillStyle=this.p[0][0].p.ca((h+.5)/i,!0),t.fillRect(0,h,e,1);if(N)for(h=s-1;0<=h;h--)this.dp(this.p[0],h,t,!0);for(1==L&&(this.df(t),this.df(t,r)),s=this.p[1].length-1,h=s-1;0<=h;h--)this.p.forEach(((e,i)=>i?this.dp(e,h,t):null));0==L&&(this.df(t),this.df(t,r))}dn(t,e,i,h){var s=Math.min;this.dx,this.dy;let r,a=s(this.p[0].length-1,h),l=0==b?.01:0;if(t.fillStyle=this.p[0][0].p.ca(1,!0),t.fillRect(0,0,2*this.dx,2*this.dy),U)for(let h=0;h<i;h++)t.fillStyle=this.p[0][0].p.ca((h+.5)/i,!0),t.fillRect(0,h,e,1);if(N)for(r=a-1;0<=r;r--)this.dp(this.p[0],r,t,!0);for(1==L&&(this.df(t),this.df(t,l)),a=s(this.p[1].length-1,h),r=a-1;0<=r;r--)this.p.forEach(((e,i)=>i?this.dp(e,r,t):null));0==L&&(this.df(t),this.df(t,l))}dt(t,e){t.fillStyle=this.p[0][0].p.ca(1,!0),t.fillRect(0,0,2*this.dx,2*this.dy),this.df(e)}w(t,e,i){this.dx=t,this.dy=e,this.m=i}}(vt,.8);kt.w(cw/2,ch/2,dt),kt.dt(xt,bt);let Tt=()=>{kt.f(10,4,.08==v?.4:.8,wt,qt),kt.n<E?at.setTimeout(Tt,0):(rt.style.transform=null,gt.removeChild(rt),kt.d(xt,cw,ch))};Tt();
      }
      function generate() {
        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        let interval = urlParams.get('interval');
        interval = interval ? parseInt(interval) : null;
        let background = urlParams.get('background');
        let hash = urlParams.get('hash');
        //generate a randomhash
        let h = "0x";
        for(var i = 0;i<64;++i){
            let n = parseInt(Math.floor(Math.random()*16));
            h+= n.toString(16);
        }
        let tokenData = {hash: hash ? hash : h, tokenId: 1000};
        if (background) {
          document.body.style.backgroundColor = background;
        }
        render_rapture(tokenData);
        if (interval) {
          setTimeout(_ => generate(), interval * 1000);
        }
      }
      window.onload = _ => generate();
    </script>
  </body>
</html>
